<?xml version="1.0" encoding="UTF-8"?>
<f:view 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets">
    <h:head >
        <link rel="shortcut icon" href="#{request.contextPath}/resources/images/idaq.png"/>
    </h:head>

    <h:body onload='$(".ui-icon-arrowthick-1-n").css("display", "none")' >
        <script src="#{request.contextPath}/resources/js/fresco/default.js" type="text/javascript"/>
        <h:outputStylesheet name="css/default.css" />
        <h:form id="form">

            <f:event type="preRenderComponent" listener="#{login.checkSession}"/>
            <p:growl id="growl1" showDetail="true"  />
            <p:dataTable rowStyleClass="rowClass" style="font-size: 13px; font-style: normal;" id="customerTable" var="customer"  value="#{customerManager.customerList}" widgetVar="customersTable"
                         emptyMessage="No Customers found with given criteria" filteredValue="#{customerManager.filteredCustomers}" paginator="true" rows="10"
                         paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink} "
                         rowsPerPageTemplate="5,10,15" sortMode="multiple"  draggableColumns="true"  rowKey="#{customer.customerId}" >

                <f:facet name="header">
                    <p:commandButton style="float: left" value="Add" icon="ui-icon-plus" action="#{customerManager.addCustomer()}" type="submit" ajax="false"/>
                    <p:commandButton id="toggler" type="link" value="Columns" style="float:right" icon="ui-icon-calculator" />
                    <p:columnToggler datasource="customerTable" trigger="toggler"  />
                    <p:outputPanel>
                        <h:outputText value="Search all available fields:" />
                        <p:inputText id="globalFilter" onkeyup="PF('customersTable').filter()" style="width:150px" placeholder="Enter keyword"/>
                    </p:outputPanel>
                </f:facet>
                <p:column exportable="false" headerText="Image" width="62">
                    <p:graphicImage rendered="#{not empty customer.customerImage}" url="/DisplayImage?type=ps&amp;pid=#{customer.customerId}" style="margin-left: auto; margin-right: auto; display: block;" width="60" height="80"/>
                    <p:graphicImage rendered="#{empty customer.customerImage}" url="/resources/images/unknown.jpg" style="margin-left: auto; margin-right: auto; display: block;" width="60" height="80"/>

                </p:column>
                <p:column  filterBy="#{customer.customerName}" headerText="Name" sortBy="#{customer.customerName}"  filterMatchMode="contains">
                    <h:outputText value="#{customer.customerName}" />
                </p:column>
                
                <p:column  filterBy="#{customer.firstBusinessEmail}" headerText="E-Mail"  width="15%" styleClass="not-show-at-start" filterMatchMode="contains" >
                    <h:outputText value="#{customer.firstBusinessEmail}"/>
                </p:column>

                <p:column filterBy="#{customer.customerMobileNo}" headerText="Tell(Mobile)"  filterMatchMode="contains">
                    <h:outputText value="#{customer.customerMobileNo}" />
                </p:column>

                <p:column filterBy="#{customer.customerRate}" headerText="Class"  width="6%" sortBy="#{customer.customerRate}" filterMatchMode="contains">

                    <h:outputText value="#{customer.customerRate}" />
                </p:column>
                <p:column filterBy="#{customer.customerPrograms}" headerText="Programs" width="6%" filterMatchMode="contains">
                    <h:outputText value="#{customer.customerPrograms}" />
                </p:column>
                <p:column filterBy="#{customer.firstBusinessName}" headerText="Business Name" filterMatchMode="contains">
                    <h:outputText value="#{customer.firstBusinessName}" />
                </p:column>
<!--                <p:column  filterBy="#{customer.donPersonalList.get(0).don361description}" headerText="Comments" styleClass="not-show-at-start" filterMatchMode="contains">
                    <h:outputText value="#{customer.donPersonalList.get(0).don361description}" />
                </p:column>-->
            <!--    <p:column  filterBy="#{customer.donPersonalList.get(0).don361homeAddress}" width="10%"  rowspan="1" headerText="Address" filterMatchMode="contains">
                    <h:outputText value="#{customer.donPersonalList.get(0).don361homeAddress}" />
                </p:column>
                  !-->

                <p:column  filterBy="#{customer.firstBusinessAddress}" width="10%"  rowspan="1" headerText="Address" filterMatchMode="contains">
                    <h:outputText value="#{customer.FirstBusinessAddress}" />
                </p:column>

<!--                <p:column filterBy="#{customer.donBussinessList.get(0).don368tag}" headerText="Business Tags" filterMatchMode="contains">
                    <h:outputText value="#{customer.donBussinessList.get(0).don368tag}" />
                </p:column>-->
<!--                <p:column filterBy="#{customer.don360customerEcoRate}" headerText="Financial status" sortBy="#{customer.don360customerEcoRate}" filterMatchMode="contains">
                    <h:outputText value="#{customer.don360customerEcoRate}" />
                </p:column>
                <p:column filterBy="#{customer.don360paymentStatus}" headerText="Payment status" sortBy="#{customer.don360paymentStatus}" filterMatchMode="contains">
                    <h:outputText value="#{customer.don360paymentStatus}" />
                </p:column>-->
                <p:column filterBy="#{customer.firstBusinessField}" headerText="Business Fields" filterMatchMode="contains">
                    <h:outputText value="#{customer.firstBusinessField}" />
                </p:column>

                <p:column width="40" style="max-width: 40px;" exportable="false" >
                    <p:commandButton ajax="false" action="#{customerManager.viewCustomer(customer)}" icon="ui-icon-search" title="View"/>
                    <p:commandButton  icon="ui-icon-close" actionListener="#{customerManager.removeRow(customer)}" update="@form" title="Delete">
                        <p:confirm header="Confirmation" message="Are you sure?" icon="ui-icon-alert" />
                    </p:commandButton>
                    
                    <p:confirmDialog global="true"  showEffect="fade" hideEffect="fade">
                        <p:commandButton value="Yes" type="button"  styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                        <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                    </p:confirmDialog>
                    
                </p:column>

            </p:dataTable>

            <h:commandLink>
                <p:graphicImage name="/images/excel.png" />
                <p:dataExporter  type="xls" target="customerTable" fileName="students" />
            </h:commandLink>
            <p:commandLink value="Logout #{login.onlineUser.usersName}" action="#{login.logout}" style="float: right; color: #f6a828;" />
        </h:form>
    </h:body>
</f:view>